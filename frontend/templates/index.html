<!doctype html>
<html>
<head>
  <title>STT Service</title>
</head>
<body>
  <h1>Speech â†’ Text</h1>
  <form id="frm" enctype="multipart/form-data">
    <input name="user_id" placeholder="Your user ID" required><br>
    <input type="file" name="audio" accept="audio/*" required><br>
    <button>Transcribe</button>
  </form>
  <pre id="out"></pre>

  <h2>Search</h2>
  <input id="sid" placeholder="Your user ID"><button id="srch">Get Conversation</button>
  <pre id="conv"></pre>

  <script>
  document.getElementById('frm').onsubmit = async e => {
    e.preventDefault();
    let data = new FormData(e.target);
    let res = await fetch('/upload',{method:'POST',body:data});
    document.getElementById('out').innerText = JSON.stringify(await res.json(),null,2);
  };
  document.getElementById('srch').onclick = async () => {
    let uid = document.getElementById('sid').value;
    let res = await fetch(`/do_search?user_id=${uid}`);
    document.getElementById('conv').innerText = JSON.stringify(await res.json(),null,2);
  };
  </script>
</body>
</html>
